A week after Russia invaded Ukraine, Moscow’s ambassador to Bulgaria climbed a snowy mountain pass to honor czarist-era Russian soldiers who died there fighting for Bulgarian independence in the 19th century.

Present day concerns, however, quickly eclipsed the effort to remind Bulgaria of the debt it owed Russia. That same day, Bulgaria expelled two of the ambassador’s underlings for espionage and announced the arrest of a senior military officer on charges of spying for Russia.

In the weeks since, Bulgaria, a country that Moscow long counted as its most ardent and reliable friend in Europe, has joined fellow members of the European Union in imposing ever tougher economic sanctions on Russia, offered to repair broken military helicopters and tanks for Ukraine, and expelled yet more Russian diplomats.

“Traditionally, Russia has always had a big influence here, but we have been a big surprise to them,” Prime Minister Kiril Petkov said in an interview last week in Sofia, the Bulgarian capital. “They don’t understand what happened,” he added.

The rapid souring of relations with Bulgaria, a poor but symbolically important country because of its historically close ties to Russia, underscores how far off-script the invasion of Ukraine ordered by President Vladimir V. Putin has veered, and not only on the battlefield.

Russia, furious at what it sees as its wayward friend’s insolence, last month abruptly halted supplies of natural gas to Bulgaria by Gazprom, making its erstwhile Balkan ally the first country along with Poland targeted by Moscow’s energy weapon.

At the same time, Mr. Petkov said, Moscow launched cyberattacks, assaulting the server of Bulgaria’s state energy company and crippling pension payments by its postal service. “We are under severe attack at the moment,” he said, describing this as a clear “attempt to derail our government” by stoking domestic unrest.

“They are trying to make an example of us,” Mr. Petkov said, describing Russia’s energy squeeze on his country as aimed at creating a situation in which “energy prices will go through the roof and our government will fall.”

Whether Mr. Petkov’s already fragile coalition government, formed after inconclusive elections in November, survives now depends to a large extent on its ability to patch together alternative sources of energy with help from the European Union, which Bulgaria joined in 2007, and the United States. Mr. Petkov this week visited Washington, where Vice President Kamala Harris pledged U.S. “solidarity in the face of Russia’s latest attempt to use energy as a weapon.”

Assen Vassilev, Bulgaria’s finance minister and deputy prime minister, insisted that Bulgaria was already well on its way to securing substitute supplies of gas by pipeline from Azerbaijan and through deliveries by sea of liquefied natural gas to terminals in neighboring Greece for transport north to Bulgaria.

“For us, obviously, Gazprom is now in the past,” Mr. Vassilev said in an interview. Moscow, he added, had overplayed its hand, prodding normally feuding Balkan nations into fast joint action to counter the danger of Russia suddenly cutting off supplies.

“This,” he said, “gives me a lot of hope that the gas weapon will be not only a paper tiger but will backfire.”

Already clear from Russia’s rift with Bulgaria is that its faltering progress on the battlefield in Ukraine has been accompanied by often self-inflicted setbacks on the diplomatic front.

Moscow has kept China onside and rallied support in Africa and parts of Latin America, but elsewhere it has displayed a striking capacity to lose friends and alienate people.

Russia’s foreign minister, Sergey V. Lavrov, for example, recently infuriated many people in Israel, a country that had mostly sat on the fence over the war in Ukraine, by claiming that Jews were “the biggest anti-Semites” and that Hitler had Jewish origins. President Putin later apologized to Israel for the remarks.

The Russian ambassador in Sofia, Eleonora Mitrofanova, scored another own-goal  by describing Bulgaria as America’s “bedpan,” an insult that her embassy later blamed on a faulty translation.